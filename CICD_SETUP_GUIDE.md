# ุฑุงูููุง ุชูุธู GitHub Actions ู CI/CD Pipeline

## ๐ ููุฏูู

ุงู ูพุฑูฺู ุดุงูู ฺฉ ูพุงูพโูุงู CI/CD ฺฉุงูู ุจุง GitHub Actions ุงุณุช ฺฉู ุดุงูู ููุงุฑุฏ ุฒุฑ ูโุดูุฏ:
- **CI Pipeline**: ุชุณุช ุฎูุฏฺฉุงุฑ ู Build ฺฉุฏ
- **CD Pipeline**: ุณุงุฎุช ู Push ุงูุฌโูุง Docker
- **Deploy Pipeline**: ุงุณุชูุฑุงุฑ ุฎูุฏฺฉุงุฑ ุฑู ุณุฑูุฑ

---

## ๐ ูพุดโูุงุฒูุง

1. **ุญุณุงุจ ฺฉุงุฑุจุฑ GitHub**
2. **ุญุณุงุจ ฺฉุงุฑุจุฑ Docker Hub** (ุจุฑุง ุฐุฎุฑู ุงูุฌโูุง)
3. **ุณุฑูุฑ ูููฺฉุณ** (ุงุฎุชุงุฑ - ุจุฑุง ุงุณุชูุฑุงุฑ ุฎูุฏฺฉุงุฑ)
4. **Git** ูุตุจ ุดุฏู ุฑู ุณุณุชู ูุญู

---

## ๐ ุชูุธู GitHub Secrets

ุจุฑุง ูุนุงูโุณุงุฒ ูพุงูพโูุงูุ ุจุงุฏ Secrets ุฒุฑ ุฑุง ุฏุฑ ูุฎุฒู GitHub ุฎูุฏ ุชูุธู ฺฉูุฏ:

### ูุฑุงุญู ุชูุธู Secrets:

1. ุจู ูุฎุฒู GitHub ุฎูุฏ ุจุฑูุฏ
2. ุจู **Settings** > **Secrets and variables** > **Actions** ุจุฑูุฏ
3. ุฑู **New repository secret** ฺฉูฺฉ ฺฉูุฏ
4. ูุฑ ฺฉ ุงุฒ Secrets ุฒุฑ ุฑุง ุงุถุงูู ฺฉูุฏ:

### ๐ Secrets ููุฑุฏ ูุงุฒ

#### ุจุฑุง Docker Hub (ุถุฑูุฑ):
```
DOCKER_USERNAME
```
- **ุชูุถุญ**: ูุงู ฺฉุงุฑุจุฑ Docker Hub ุดูุง
- **ูุซุงู**: `myusername`

```
DOCKER_PASSWORD
```
- **ุชูุถุญ**: ุฑูุฒ ุนุจูุฑ ุง Access Token ุงุฒ Docker Hub
- **ูฺฉุชู ููู**: ุงุณุชูุงุฏู ุงุฒ Access Token ุงููโุชุฑ ุงุณุช
- **ูุญูู ุงุฌุงุฏ Token**: 
  - ุจู [Docker Hub](https://hub.docker.com) ุจุฑูุฏ
  - Settings > Security > New Access Token
  - ฺฉ Token ุจุง ุฏุณุชุฑุณ Read & Write ุงุฌุงุฏ ฺฉูุฏ

#### ุจุฑุง ุงุณุชูุฑุงุฑ ุฎูุฏฺฉุงุฑ (ุงุฎุชุงุฑ):

```
SERVER_HOST
```
- **ุชูุถุญ**: ุขุฏุฑุณ IP ุง ุฏุงููู ุณุฑูุฑ ุดูุง
- **ูุซุงู**: `192.168.1.100` ุง `example.com`

```
SERVER_USER
```
- **ุชูุถุญ**: ูุงู ฺฉุงุฑุจุฑ SSH ุณุฑูุฑ
- **ูุซุงู**: `root` ุง `ubuntu`

```
SERVER_PATH
```
- **ุชูุถุญ**: ูุณุฑ ูพุฑูฺู ุฑู ุณุฑูุฑ
- **ูุซุงู**: `/home/ubuntu/talaseen`

```
SSH_PRIVATE_KEY
```
- **ุชูุถุญ**: ฺฉูุฏ ุฎุตูุต SSH ุจุฑุง ุงุชุตุงู ุจู ุณุฑูุฑ
- **ูุญูู ุงุฌุงุฏ**:
  ```bash
  # ุฏุฑ ุณุณุชู ูุญู:
  ssh-keygen -t ed25519 -C "github-actions" -f ~/.ssh/github_actions
  
  # ฺฉูพ ฺฉูุฏ ุนููู ุจู ุณุฑูุฑ:
  ssh-copy-id -i ~/.ssh/github_actions.pub user@server
  
  # ููุงุด ฺฉูุฏ ุฎุตูุต ุจุฑุง ฺฉูพ:
  cat ~/.ssh/github_actions
  ```
- **ูฺฉุชู**: ฺฉู ูุญุชูุง ูุงู ฺฉูุฏ ุฎุตูุต (ุงุฒ BEGIN ุชุง END) ุฑุง ฺฉูพ ฺฉูุฏ

---

## ๐ ูุงูโูุง Workflow

ูพุฑูฺู ุดุงูู 3 Workflow ุงุตู ุงุณุช:

### 1. CI Pipeline (`.github/workflows/ci.yml`)
- **ุฒูุงู ุงุฌุฑุง**: ูุฑ Push ุง Pull Request ุจู `main` ุง `develop`
- **ูุธุงู**:
  - ูุตุจ Dependencies
  - ุงุฌุฑุง Linting
  - Build Backend ู Frontend
  - ุงุฌุฑุง ุชุณุชโูุง (ุฏุฑ ุตูุฑุช ูุฌูุฏ)
  - ุชุณุช Build ุฏุงฺฉุฑ

### 2. CD Pipeline (`.github/workflows/cd.yml`)
- **ุฒูุงู ุงุฌุฑุง**: Push ุจู `main` ุง ุงุฌุงุฏ Tag
- **ูุธุงู**:
  - Build ุงูุฌโูุง Docker
  - Push ุจู Docker Hub
  - Tag ฺฉุฑุฏู ุฎูุฏฺฉุงุฑ (latest, version, sha)

### 3. Deploy Pipeline (`.github/workflows/deploy.yml`)
- **ุฒูุงู ุงุฌุฑุง**: ุฏุณุช ุง ุฎูุฏฺฉุงุฑ (Push ุจู `main`)
- **ูุธุงู**:
  - Pull ฺฉุฏ ุฌุฏุฏ ุฑู ุณุฑูุฑ
  - Pull ุงูุฌโูุง ุฌุฏุฏ
  - ุงุฌุฑุง Migrations
  - ุฑุงูโุงูุฏุงุฒ ูุฌุฏุฏ ฺฉุงูุชูุฑูุง
  - Health Check

---

## ๐๏ธ ูุตุจ ู ุฑุงูโุงูุฏุงุฒ

### ูุฑุญูู 1: ุงูุฒูุฏู Workflows ุจู ูุฎุฒู

ูุงูโูุง Workflow ุงุฒ ูุจู ุงุฌุงุฏ ุดุฏูโุงูุฏ. ููุท ุจุงุฏ ุขูโูุง ุฑุง ุจู ูุฎุฒู GitHub Push ฺฉูุฏ:

```bash
# ุงุถุงูู ฺฉุฑุฏู ูุงูโูุง
git add .github/

# Commit
git commit -m "Add CI/CD pipeline with GitHub Actions"

# Push ุจู GitHub
git push origin main
```

### ูุฑุญูู 2: ุชูุธู Docker Hub

1. ุจู [Docker Hub](https://hub.docker.com) ุจุฑูุฏ ู ูุงุฑุฏ ุดูุฏ
2. ฺฉ Repository ุฌุฏุฏ ุจุฑุง Backend ุงุฌุงุฏ ฺฉูุฏ:
   - ูุงู: `talaseen-backend`
   - Visibility: Public ุง Private
3. ฺฉ Repository ุฌุฏุฏ ุจุฑุง Frontend ุงุฌุงุฏ ฺฉูุฏ:
   - ูุงู: `talaseen-frontend`
   - Visibility: Public ุง Private
4. ฺฉ Access Token ุงุฌุงุฏ ฺฉูุฏ (ุชูุถุญุงุช ุจุงูุง)

### ูุฑุญูู 3: ุงูุฒูุฏู Secrets ุจู GitHub

ุทุจู ุฏุณุชูุฑุงูุนูู ุจุฎุด "ุชูุธู GitHub Secrets" ุนูู ฺฉูุฏ.

### ูุฑุญูู 4: ุชุณุช Pipeline

1. ฺฉ ุชุบุฑ ฺฉูฺฺฉ ุฏุฑ ฺฉุฏ ุงุฌุงุฏ ฺฉูุฏ
2. ุชุบุฑุงุช ุฑุง Commit ู Push ฺฉูุฏ
3. ุจู ุชุจ **Actions** ุฏุฑ GitHub ุจุฑูุฏ
4. Workflow ุฏุฑ ุญุงู ุงุฌุฑุง ุฑุง ูุดุงูุฏู ฺฉูุฏ

---

## ๐ ุงุณุชูุงุฏู ุงุฒ Workflows

### ุงุฌุฑุง ุฎูุฏฺฉุงุฑ

Workflows ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุฏุฑ ููุงุฑุฏ ุฒุฑ ุงุฌุฑุง ูโุดููุฏ:

- **CI**: ูุฑ Push ุง PR ุจู `main` ุง `develop`
- **CD**: ูุฑ Push ุจู `main`
- **Deploy**: ูุฑ Push ุจู `main` (ุงฺฏุฑ ูุนุงู ุจุงุดุฏ)

### ุงุฌุฑุง ุฏุณุช Deploy

1. ุจู ุชุจ **Actions** ุจุฑูุฏ
2. ุฑู **Deploy to Server** ฺฉูฺฉ ฺฉูุฏ
3. **Run workflow** ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ
4. ูุญุท ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ (production/staging)
5. **Run workflow** ุฑุง ฺฉูฺฉ ฺฉูุฏ

---

## ๐ท๏ธ Tag ฺฉุฑุฏู ู Release

ุจุฑุง ุงุฌุงุฏ ูุณุฎู ุฌุฏุฏ:

```bash
# ุงุฌุงุฏ Tag
git tag -a v1.0.0 -m "Release version 1.0.0"

# Push Tag
git push origin v1.0.0
```

ุงู ุนูู ุจุงุนุซ ูโุดูุฏ:
- CD Pipeline ุงุฌุฑุง ุดูุฏ
- ุงูุฌโูุง ุจุง Tag `v1.0.0` ุณุงุฎุชู ุดููุฏ
- ุงูุฌโูุง ุจุง Tag `1.0` ูุฒ ุณุงุฎุชู ุดููุฏ (major.minor)

---

## ๐ ูุธุงุฑุช ู ุนุจโุงุจ

### ูุดุงูุฏู ูุงฺฏโูุง

1. ุจู ุชุจ **Actions** ุจุฑูุฏ
2. ุฑู Workflow ููุฑุฏ ูุธุฑ ฺฉูฺฉ ฺฉูุฏ
3. ุฑู Job ููุฑุฏ ูุธุฑ ฺฉูฺฉ ฺฉูุฏ
4. ูุงฺฏโูุง ุฑุง ูุดุงูุฏู ฺฉูุฏ

### ูุดฺฉูุงุช ุฑุงุฌ ู ุฑุงูโุญูโูุง

#### 1. ุฎุทุง Authentication ุจุง Docker Hub
```
Error: Cannot perform an interactive login from a non TTY device
```
**ุฑุงูโุญู**: ูุทูุฆู ุดูุฏ `DOCKER_USERNAME` ู `DOCKER_PASSWORD` ุจู ุฏุฑุณุช ุชูุธู ุดุฏูโุงูุฏ.

#### 2. ุฎุทุง SSH Connection
```
Permission denied (publickey)
```
**ุฑุงูโุญู**: 
- ูุทูุฆู ุดูุฏ ฺฉูุฏ ุนููู ุฑู ุณุฑูุฑ ุงุถุงูู ุดุฏู
- ูุฑูุช `SSH_PRIVATE_KEY` ุฑุง ุจุฑุฑุณ ฺฉูุฏ (ุจุงุฏ ุดุงูู BEGIN ู END ุจุงุดุฏ)

#### 3. ุฎุทุง Build
```
npm ERR! code ELIFECYCLE
```
**ุฑุงูโุญู**: ูุงฺฏโูุง ฺฉุงูู ุฑุง ุจุฑุฑุณ ฺฉูุฏ ู ูุทูุฆู ุดูุฏ Dependencies ุจู ุฏุฑุณุช ูุตุจ ุดุฏูโุงูุฏ.

---

## ๐ ูุชุบุฑูุง ูุญุท

ุจุฑุง ุงุณุชูุฑุงุฑ ุฑู ุณุฑูุฑุ ุจุงุฏ ูุงู `.env` ุฑู ุณุฑูุฑ ููุฌูุฏ ุจุงุดุฏ:

### ูุงู `.env` ุงุตู (root):
```env
POSTGRES_USER=talaseen
POSTGRES_PASSWORD=your_secure_password
POSTGRES_DB=talaseen
```

### ูุงู `services/backend/.env`:
```env
DATABASE_URL="postgresql://talaseen:your_secure_password@postgres:5432/talaseen"
JWT_SECRET=your_jwt_secret_key_here
PORT=4000
```

---

## ๐ ุจูููโุณุงุฒโูุง

Pipeline ุดุงูู ุจูููโุณุงุฒโูุง ุฒุฑ ุงุณุช:

1. **Docker Layer Caching**: ุงุณุชูุงุฏู ุงุฒ GitHub Actions Cache
2. **Multi-stage Builds**: ฺฉุงูุด ุญุฌู ุงูุฌโูุง
3. **Parallel Jobs**: ุงุฌุฑุง ููุฒูุงู Backend ู Frontend CI
4. **Health Checks**: ุงุทููุงู ุงุฒ ููููุชโุขูุฒ ุจูุฏู Deploy

---

## ๐ ุงููุช

- ููู ุงุทูุงุนุงุช ุญุณุงุณ ุฏุฑ GitHub Secrets ุฐุฎุฑู ูโุดููุฏ
- Secrets ูุฑฺฏุฒ ุฏุฑ ูุงฺฏโูุง ููุงุด ุฏุงุฏู ููโุดููุฏ
- ุงุณุชูุงุฏู ุงุฒ SSH Key ุจู ุฌุง Password ุจุฑุง ุงุชุตุงู ุจู ุณุฑูุฑ
- ุงุณุชูุงุฏู ุงุฒ Docker Hub Access Token ุจู ุฌุง Password

---

## ๐ ูพุดุชุจุงู

ุงฺฏุฑ ุจุง ูุดฺฉู ููุงุฌู ุดุฏุฏ:

1. ูุงฺฏโูุง Actions ุฑุง ุจุฑุฑุณ ฺฉูุฏ
2. ูุทูุฆู ุดูุฏ ููู Secrets ุจู ุฏุฑุณุช ุชูุธู ุดุฏูโุงูุฏ
3. ูุณุฎูโูุง Node.js ู Dependencies ุฑุง ุจุฑุฑุณ ฺฉูุฏ
4. ูุงูโูุง Dockerfile ุฑุง ุจุฑุฑุณ ฺฉูุฏ

---

## ๐ ุงุฏุฏุงุดุชโูุง ููู

- **Environment Branches**: ูโุชูุงูุฏ Branch ูุง ุฌุฏุงฺฏุงูู ุจุฑุง `staging` ู `production` ุฏุงุดุชู ุจุงุดุฏ
- **Manual Approval**: ูโุชูุงูุฏ Environment Protection Rules ุฑุง ุฏุฑ GitHub ุชูุธู ฺฉูุฏ
- **Notifications**: ูโุชูุงูุฏ Webhook ุง Email notification ุงุถุงูู ฺฉูุฏ
- **Rollback**: ุฏุฑ ุตูุฑุช ูุดฺฉูุ ูโุชูุงูุฏ ุจู ูุณุฎู ูุจู ุจุฑฺฏุฑุฏุฏ:
  ```bash
  git revert HEAD
  git push origin main
  ```

---

## โ ฺฺฉโูุณุช ุฑุงูโุงูุฏุงุฒ

- [ ] Repository ุฏุฑ GitHub ุงุฌุงุฏ ุดุฏู
- [ ] ุญุณุงุจ Docker Hub ุงุฌุงุฏ ุดุฏู
- [ ] Repositories ุฏุฑ Docker Hub ุงุฌุงุฏ ุดุฏู
- [ ] Access Token ุงุฒ Docker Hub ุงุฌุงุฏ ุดุฏู
- [ ] ููู Secrets ุฏุฑ GitHub ุชูุธู ุดุฏู
- [ ] ูุงูโูุง Workflow ุจู ูุฎุฒู ุงุถุงูู ุดุฏู
- [ ] ฺฉ Push ุชุณุช ุงูุฌุงู ุดุฏู
- [ ] Workflow ูุง ุจุง ููููุช ุงุฌุฑุง ุดุฏูโุงูุฏ
- [ ] ุงูุฌโูุง ุฏุฑ Docker Hub ููุฌูุฏ ูุณุชูุฏ

---

ูููู ุจุงุดุฏ! ๐
