# راهنمای رفع خطای ایجاد محصول

## دلایل احتمالی خطا در ایجاد محصول:

### 1️⃣ پروفایل فروشنده وجود ندارد
**پیام خطا:** `پروفایل فروشنده شما پیدا نشد. لطفاً ابتدا درخواست فروشندگی دهید.`

**راه حل:**
- به صفحه اصلی بروید
- روی دکمه "درخواست فروشندگی" کلیک کنید
- فرم را پر کنید و ارسال کنید
- منتظر تایید مدیر بمانید

### 2️⃣ پروفایل فروشنده تایید نشده
**پیام خطا:** `پروفایل فروشنده شما هنوز تایید نشده است. لطفاً منتظر تایید مدیر بمانید.`

**راه حل:**
- درخواست شما در حال بررسی است
- مدیر باید پروفایل شما را تایید کند
- بعد از تایید، می‌توانید محصول اضافه کنید

### 3️⃣ نقش کاربری مناسب ندارید
**پیام خطا:** `Forbidden resource`

**راه حل:**
- کاربر باید نقش SELLER یا ADMIN داشته باشد
- ابتدا درخواست فروشندگی دهید

### 4️⃣ فیلدهای ضروری خالی است
**پیام خطا:** `لطفاً تمام فیلدهای ضروری را پر کنید`

**فیلدهای ضروری:**
- ✅ عنوان محصول
- ✅ نوع محصول
- ✅ وزن (گرم)
- ✅ قیمت طلا (تومان/گرم)
- ✅ حداقل یک تصویر

### 5️⃣ مشکل در آپلود تصویر
**پیام خطا:** `آپلود تصویر ناموفق بود`

**راه حل:**
- بررسی کنید اتصال اینترنت برقرار است
- حجم تصاویر نباید خیلی زیاد باشد
- فرمت تصاویر باید JPG، PNG یا WebP باشد

## نحوه بررسی وضعیت پروفایل فروشنده:

### از طریق API:
```bash
# بررسی پروفایل کاربر فعلی
curl -X GET http://localhost:4000/api/auth/me \
  -H "Authorization: Bearer YOUR_TOKEN"

# بررسی پروفایل فروشنده
curl -X GET http://localhost:4000/api/auth/my-seller \
  -H "Authorization: Bearer YOUR_TOKEN"
```

### از طریق دیتابیس:
```sql
-- بررسی پروفایل فروشنده
SELECT * FROM "Seller" WHERE "userId" = 'USER_ID';

-- بررسی نقش کاربر
SELECT id, name, email, role FROM "User" WHERE id = 'USER_ID';
```

## مراحل ایجاد محصول:

1. **ورود به سیستم** (با Google)
2. **درخواست فروشندگی** (اگر هنوز فروشنده نیستید)
3. **منتظر تایید مدیر** بمانید
4. **ایجاد محصول** از پنل فروشنده

## کدهای خطای احتمالی:

| کد | پیام | دلیل |
|----|------|------|
| 401 | Unauthorized | توکن نامعتبر یا منقضی شده |
| 403 | Forbidden | نقش کاربری مناسب ندارید |
| 404 | Seller profile not found | پروفایل فروشنده وجود ندارد |
| 400 | Bad Request | داده‌های ورودی نامعتبر |
| 500 | Internal Server Error | خطای سرور |

## دستورات مفید برای Debug:

```bash
# بررسی لاگ‌های backend
docker compose logs backend --tail 100

# بررسی لاگ‌های لحظه‌ای
docker compose logs -f backend

# ورود به container backend
docker compose exec backend sh

# بررسی دیتابیس
docker compose exec postgres psql -U postgres -d talaseen
```

## اسکریپت‌های کمکی:

```bash
# ایجاد ادمین
cd services/backend
npm run create-admin

# تبدیل کاربر به فروشنده
docker compose exec backend npx ts-node scripts/promote-seller.ts USER_EMAIL
```
